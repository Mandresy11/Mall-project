<nav class="navbar">
  <div class="nav-container">

    <!-- Logo -->
    <a routerLink="/" class="logo">
      <span class="logo-icon">üè¨</span>
      <span class="logo-text">MegaMall</span>
    </a>

    <!-- Liens de navigation -->
    <ul class="nav-menu">
      <li>
        <a routerLink="/" routerLinkActive="active"
           [routerLinkActiveOptions]="{exact: true}" class="nav-link">Accueil</a>
      </li>
      <li>
        <a routerLink="/boutiques" routerLinkActive="active" class="nav-link">Boutiques</a>
      </li>
      <li>
        <a routerLink="/produits" routerLinkActive="active" class="nav-link">Produits</a>
      </li>
      <li>
        <a routerLink="/evenements" routerLinkActive="active" class="nav-link">√âv√©nements</a>
      </li>
    </ul>


    <div class="nav-actions">

      <!--non connect√©-->
      <ng-container *ngIf="!utilisateur">
        <button class="btn-connexion"   (click)="ouvrirConnexion()">Connexion</button>
        <button class="btn-inscription" (click)="ouvrirInscription()">Inscription</button>
      </ng-container>

      <!--connect√©-->
      <div class="user-menu" *ngIf="utilisateur">
        <button class="btn-avatar" (click)="toggleMenuUtilisateur()">
          <span class="avatar-initiales">{{ getInitiales() }}</span>
          <span class="user-nom">{{ utilisateur.fullname }}</span>
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2"
               [style.transform]="menuUtilisateurOuvert ? 'rotate(180deg)' : ''"
               style="transition: transform 0.2s ease">
            <polyline points="6 9 12 15 18 9"/>
          </svg>
        </button>

        <!-- Dropdown -->
        <div class="dropdown" *ngIf="menuUtilisateurOuvert">
          <!-- En-t√™te avec infos utilisateur -->
          <div class="dropdown-header">
            <div class="avatar-grand">{{ getInitiales() }}</div>
            <div class="dropdown-infos">
              <div class="dropdown-nom">{{ utilisateur.fullname }}</div>
              <div class="dropdown-username">@{{ utilisateur.username }}</div>
              <div class="dropdown-role">{{ utilisateur.role }}</div>
            </div>
          </div>

          <hr class="dropdown-divider" />

          <!-- Lien profil -->
          <button class="dropdown-item" (click)="menuUtilisateurOuvert = false">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
            Mon profil
          </button>

          <!-- D√©connexion -->
          <button class="dropdown-item deconnexion" (click)="deconnecter()">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            Se d√©connecter
          </button>
        </div>
      </div>

    </div>

    <!-- Burger mobile -->
    <button class="menu-burger" (click)="menuOuvert = !menuOuvert"
            [class.ouvert]="menuOuvert">
      <span></span>
      <span></span>
      <span></span>
    </button>

  </div>

  <!-- Menu mobile -->
  <div class="mobile-menu" [class.ouvert]="menuOuvert">
    <a routerLink="/"          class="mobile-link" (click)="menuOuvert = false">Accueil</a>
    <a routerLink="/boutiques" class="mobile-link" (click)="menuOuvert = false">Boutiques</a>
    <a routerLink="/produits"  class="mobile-link" (click)="menuOuvert = false">Produits</a>
    <a routerLink="/evenements"class="mobile-link" (click)="menuOuvert = false">√âv√©nements</a>
    <div class="mobile-actions">
      <ng-container *ngIf="!utilisateur">
        <button class="btn-connexion"   (click)="ouvrirConnexion()">Connexion</button>
        <button class="btn-inscription" (click)="ouvrirInscription()">Inscription</button>
      </ng-container>
      <ng-container *ngIf="utilisateur">
        <span class="mobile-user">üë§ {{ utilisateur.fullname }}</span>
        <button class="btn-connexion" (click)="deconnecter()">Se d√©connecter</button>
      </ng-container>
    </div>
  </div>
</nav>

<!-- Modal d'authentification -->
<app-auth-modal
  *ngIf="modalVisible"
  [modeInitial]="modeModal"
  (fermer)="fermerModal()"
  (connecte)="onConnecte()"
></app-auth-modal>
